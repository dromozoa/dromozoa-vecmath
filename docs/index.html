<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>dromozoa-vecmath</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
</head>
<style>
.markdown-body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
}
@media (max-width: 767px) {
  .markdown-body {
    padding: 15px;
  }
}
</style>
<body>
<div class="markdown-body">

<h1>dromozoa-vecmath</h1>

<h2>リンク</h2>

<ul>
  <li><a href="https://download.java.net/media/java3d/javadoc/1.5.0/index.html">Java 3D 1.5.0</a></li>
  <li><a href="http://objectclub.jp/download/vecmath1">unofficial Java3D vecmath package</a></li>
  <li><a href="https://eigen.tuxfamily.org/">Eigen</a>
    <ul>
      <li><a href="https://eigen.tuxfamily.org/dox/classEigen_1_1JacobiSVD.html">JacobiSVD</a></li>
      <li><a href="https://eigen.tuxfamily.org/dox/classEigen_1_1BDCSVD.html">BDCSVD</a></li>
    </ul>
  </li>
  <li><a href="https://www.cs.utexas.edu/users/inderjit/public_papers/HLA_SVD.pdf">Computation of the Singular Value Decomposition</a></li>
  <li><a href="https://www.irisa.fr/sage/bernard/publis/SVD-Chapter06.pdf">Parallel Algorithms for the Singular Value Decomposition</a></li>
  <li><a href="http://nalab.mind.meiji.ac.jp/~mk/labo/text/eigenvalues-add.pdf">固有値問題ノートの補足</a></li>
</ul>

<h2>特異値分解</h2>

<h3>固有値と特異値</h3>

<p>
\(3 \times 3\)行列\(m\)が与えられたとき、\(M = m m^*\)を固有値分解してユニタリ行列\(U\)と固有値行列\(S\)を得る。
\[
  (U, S) = \mathrm{eig}(M)
\]
\(m\)を特異値分解すると、
\[\begin{eqnarray}
  m   &amp;=&amp; u s v^* \\
  u   &amp;=&amp; U \\
  s   &amp;=&amp; \sqrt{S} \\
  v^* &amp;=&amp; s^{-1} U^* m
\end{eqnarray}\]
回転成分\(u v^*\)は、
\[
  u v^* = U s^{-1} U^* m
\]
ランクが3でない場合、特異値が0になるので問題がある。
</p>

<h3>ヤコビ法による固有値分解</h3>

<p>
適当な\(p,q\)を選び、収束計算を行う。
\(m_{pq}=m_{qp}\)でなければならない。
\[
  \begin{pmatrix}
    \cos\theta &amp; -\sin\theta \\
    \sin\theta &amp;  \cos\theta
  \end{pmatrix}
  \begin{pmatrix}
    m_{pp} &amp; m_{pq} \\
    m_{qp} &amp; m_{qq}
  \end{pmatrix}
  \begin{pmatrix}
     \cos\theta &amp; \sin\theta \\
    -\sin\theta &amp; \cos\theta
  \end{pmatrix}
  =
  \begin{pmatrix}
    s_p &amp;   0 \\
      0 &amp; s_q
  \end{pmatrix}
\]
</p>

<h3>ヤコビ法による特異値分解</h3>

<p>
適当な\(p,q\)を選び、収束計算を行う。
\[
  \begin{pmatrix}
    \cos\theta &amp; -\sin\theta \\
    \sin\theta &amp;  \cos\theta
  \end{pmatrix}
  \begin{pmatrix}
    m_{pp} &amp; m_{pq} \\
    m_{qp} &amp; m_{qq}
  \end{pmatrix}
  \begin{pmatrix}
     \cos\phi &amp; \sin\phi \\
    -\sin\phi &amp; \cos\phi
  \end{pmatrix}
  \begin{pmatrix}
     \cos\theta &amp; \sin\theta \\
    -\sin\theta &amp; \cos\theta
  \end{pmatrix}
  =
  \begin{pmatrix}
    s_p &amp;   0 \\
      0 &amp; s_q
  \end{pmatrix}
\]
\(\phi\)は\(m\)を対称行列にするための回転で、
\[
  \tan\phi = \frac{m_{qp} - m_{pq}}{m_{pp} + m_{qq}}
\]
</p>

<h2>\(3 \times 3\)行列のクロス積正規化</h2>

<h3>Sunの実装</h3>

<p>
\[\begin{eqnarray}
  A &amp;=&amp; \left(
    \begin{array}{ccc}
      a_{11} &amp; a_{12} &amp; a_{13} \\
      a_{21} &amp; a_{22} &amp; a_{23} \\
      a_{31} &amp; a_{32} &amp; a_{33}
    \end{array}
  \right) \\
  A_1 &amp;=&amp; (a_{11}, a_{21}, a_{31}) \\
  A_2 &amp;=&amp; (a_{12}, a_{22}, a_{32}) \\
  B &amp;=&amp; \left(
    \begin{array}{ccc}
      \frac{A_1}{\|A_1\|} &amp;
      \frac{A_2}{\|A_2\|} &amp;
      \frac{A_1}{\|A_1\|} \times \frac{A_2}{\|A_2\|}
    \end{array}
  \right) \\
  &amp;=&amp; \left(
    \begin{array}{ccc}
      \frac{a_{11}}{\|A_1\|} &amp; \frac{a_{12}}{\|A_2\|} &amp; \frac{a_{21} a_{32} - a_{22} a_{31}}{\|A_1\| \|A_2\|} \\
      \frac{a_{21}}{\|A_1\|} &amp; \frac{a_{22}}{\|A_2\|} &amp; \frac{a_{31} a_{12} - a_{32} a_{11}}{\|A_1\| \|A_2\|} \\
      \frac{a_{31}}{\|A_1\|} &amp; \frac{a_{32}}{\|A_2\|} &amp; \frac{a_{11} a_{22} - a_{12} a_{21}}{\|A_1\| \|A_2\|}
    \end{array}
  \right)
\end{eqnarray}\]
</p>


<h3>平鍋の実装</h3>

<p>
\[
  B = \sqrt[3]{\mathrm{det}(A)} A
\]
</p>

</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  CommonHTML: {
    undefinedFamily: "sans-serif"
  }
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML"></script>
</body>
</html>
