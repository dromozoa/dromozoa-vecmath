<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>dromozoa-vecmath</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css">
<style>
.markdown-body {
  box-sizing: border-box;
  min-width: 200px;
  max-width: 980px;
  margin: 0 auto;
  padding: 45px;
}
@media (max-width: 767px) {
  .markdown-body {
    padding: 15px;
  }
}
</style>
</head>
<body>
<div class="markdown-body">

<h1>曲線</h1>

<h2>Bernstein Polynominal</h2>

<p>
\(n\)次のバーンスタイン基底関数は
\[\begin{aligned}
  B_{i,n}(t)
  &amp;=
  \binom{n}{i}
  t^i (1-t)^{n-i}, \quad i = 0, \dots, n \\

  \binom{n}{i}
  &amp;=
  \frac{n!}{i! (n-i)!} \\
\end{aligned}\]
\(n\)次のバーンスタイン基底関数を微分すると
\[
  B_{i,n}'(t)
  =
  \binom{n}{i}
  \frac{
    t^i (1-t)^{n-i} (i - nt)
  }{
    t(1-t)
  }
\]
</p>

<h3>Maxima</h3>

<pre>
define(B(i,n,t), binomial(n,i) * t^i * (1-t)^(n-i));
</pre>

<h2>B&eacute;zier Curve</h2>

<p>
\(n\)次のB&eacute;zier曲線は
\[\begin{aligned}
  \bm{P}(t) = \sum_{i=0}^n B_{i,n}(t) \bm{p_i}
\end{aligned}\]
\(n\)次のB&eacute;zier曲線を微分すると
\[
  \bm{P}'(t) = n \sum_{i=0}^{n-1} B_{i,n-1}(t) (\bm{p_{i+1}} - \bm{p_i})
\]
<p>

<h2>Rational B&eacute;zier</h2>

</p>
\(n\)次のRational B&eacute;zier曲線は
\[\begin{aligned}
  \bm{P}(t) = \frac{
    \sum_{i=0}^n B_{i,n}(t) w_i \bm{p_i}
  }{
    \sum_{i=0}^n B_{i,n}(t) w_i
  }
\end{aligned}\]
\(n\)次のRational B&eacute;zier曲線を微分すると
\[\begin{aligned}
  \bm{P}'(t)
  &amp;=
  \sum_{i=0}^{n-1} \lambda_i(t) (\bm{p_{i+1}} - \bm{p_i}) \\

  \lambda_i(t)
  &amp;=
  \frac{1}{t(1-t) w_{0,n}^2(t)}
  \sum_{j=0}^i \sum_{k=i+1}^n (k-j) B_{j,n}(t) B_{k,n}(t) w_j w_k \\

  w_{i,k}(t)
  &amp;=
  \sum_{j=0}^k B_{j,k}(t) w_{i+j} \\

  w_{0,n}(t)
  &amp;=
  \sum_{j=0}^n B_{j,n}(t) w_{j} \\
\end{aligned}\]
</p>

<h2>1次 (Linear) B&eacute;zier</h2>

<p>
\[\begin{aligned}
  B_{0,1}(t) &amp;=   1-t \\
  B_{0,1}(t) &amp;= t     \\
\end{aligned}\]
\[\begin{aligned}
  B_{0,1}'(t) &amp;= -1 \\
  B_{1,1}'(t) &amp;=  1 \\
\end{aligned}\]
</p>

<h2>2次 (Quadratic) B&eacute;zier</h2>

<p>
\[\begin{aligned}
  B_{0,2}(t) &amp;=       (1-t)^2 \\
  B_{1,2}(t) &amp;= 2 t   (1-t)   \\
  B_{2,2}(t) &amp;=   t^2         \\
\end{aligned}\]
\[\begin{aligned}
  B_{0,2}'(t) &amp;= -2 (1-t)  \\
  B_{1,2}'(t) &amp;=  2 (1-2t) \\
  B_{2,2}'(t) &amp;=  2 t      \\
\end{aligned}\]
\(w_0 = w_2 = 1\)のとき
\[\begin{aligned}
  \lambda_0(t) &amp;= \frac{
    B_{0,2}(t) B_{1,2}(t) w_1 + 2 B_{0,2}(t) B_{2,2}(t)
  }{
    t (1-t) (B_{0,2}(t) + B_{1,2}(t) w_1 + B_{2,2}(t))
  } \\

  \lambda_1(t) &amp;= \frac{
    2 B_{0,2}(t) B_{2,2}(t) + B_{1,2}(t) B_{2,2}(t) w_1
  }{
    t (1-t) (B_{0,2}(t) + B_{1,2}(t) w_1 + B_{2,2}(t))
  } \\

\end{aligned}\]
</p>

<h3>Maxima</h3>

<pre>
define(P2(t), B(0,2,t)*p0 + B(1,2,t)*p1 + B(2,2,t)*p2);
</pre>

<pre>
define(W2(t,w0,w1,w2), B(0,2,t)*w0 + B(1,2,t)*w1 + B(2,2,t)*w2);
</pre>

<pre>
define(R2(t,w0,w1,w2),
  (B(0,2,t)*w0*p0 + B(1,2,t)*w1*p1 + B(2,2,t)*w2*p2)
  /
  W2(t,w0,w1,w2)
);
</pre>

<pre>
/* n=2, i=0, (j,k)=(0,1),(0,2) */
define(L2_0(t,w0,w1,w2),
  1 / (t * (1-t) * W2(t,w0,w1,w2)^2) * (
    1 * B(0,2,t) * B(1,2,t) * w0 * w1 +
    2 * B(0,2,t) * B(2,2,t) * w0 * w2 )
);
</pre>

<pre>
/* n=2, i=1, (j,k)=(0,2),(1,2) */
define(L2_1(t,w0,w1,w2),
  1 / (t * (1-t) * W2(t,w0,w1,w2)^2) * (
    2 * B(0,2,t) * B(2,2,t) * w0 * w2 +
    1 * B(1,2,t) * B(2,2,t) * w0 * w1 )
);
</pre>

<h2>3次 (Cubic) B&eacute;zier</h2>

<p>
\[\begin{aligned}
  B_{0,3}(t) &amp;=       (1-t)^3 \\
  B_{1,3}(t) &amp;= 3 t   (1-t)^2 \\
  B_{2,3}(t) &amp;= 3 t^2 (1-t)   \\
  B_{3,3}(t) &amp;=   t^3         \\
\end{aligned}\]
\[\begin{aligned}
  B_{0,3}'(t) &amp;= -3     (1-t)^2        \\
  B_{1,3}'(t) &amp;=  3     (1-t)   (1-3t) \\
  B_{2,3}'(t) &amp;=  3 t           (2-3t) \\
  B_{3,3}'(t) &amp;=  3 t^2                \\
\end{aligned}\]
</p>

<h3>Maxima</h3>

<pre>
define(P3(t), B(0,3,t)*p0 + B(1,3,t)*p1 + B(2,3,t)*p2 + B(3,3,t)*p3);
</pre>

<pre>
define(W3(t,w0,w1,w2,w3), B(0,3,t)*w0 + B(1,3,t)*w1 + B(2,3,t)*w2 + B(3,3,t)*w3);
</pre>

<pre>
define(R3(t,w0,w1,w2,w3),
  (B(0,3,t)*w0*p0 + B(1,3,t)*w1*p1 + B(2,3,t)*w2*p2 + B(3,3,t)*w3*p3)
  /
  W3(t,w0,w1,w2,w3)
);
</pre>

<pre>
/* n=3, i=0, (j,k)=(0,1),(0,2),(0,3) */
define(L3_0(t,w0,w1,w2,w3),
  1 / (t * (1-t) * W3(t,w0,w1,w2,w3)^2) * (
    1 * B(0,3,t) * B(1,3,t) * w0 * w1 +
    2 * B(0,3,t) * B(2,3,t) * w0 * w2 +
    3 * B(0,3,t) * B(3,3,t) * w0 * w3 )
);
</pre>

<pre>
/* n=3, i=1, (j,k)=(0,2),(0,3),(1,2),(1,3) */
define(L3_1(t,w0,w1,w2,w3),
  1 / (t * (1-t) * W3(t,w0,w1,w2,w3)^2) * (
    2 * B(0,3,t) * B(2,3,t) * w0 * w2 +
    3 * B(0,3,t) * B(3,3,t) * w0 * w3 +
    1 * B(1,3,t) * B(2,3,t) * w1 * w2 +
    2 * B(1,3,t) * B(3,3,t) * w1 * w3 )
);
</pre>

<pre>
/* n=3, i=2, (j,k)=(0,3),(1,3),(2,3) */
define(L3_2(t,w0,w1,w2,w3),
  1 / (t * (1-t) * W3(t,w0,w1,w2,w3)^2) * (
    3 * B(0,3,t) * B(3,3,t) * w0 * w3 +
    2 * B(1,3,t) * B(3,3,t) * w1 * w3 +
    1 * B(2,3,t) * B(3,3,t) * w2 * w3 )
);
</pre>

<h2>4次 (Quartic) B&eacute;zier</h2>

<p>
\[\begin{aligned}
  B_{0,4}(t) &amp;=       (1-t)^4 \\
  B_{1,4}(t) &amp;= 4 t   (1-t)^3 \\
  B_{2,4}(t) &amp;= 6 t^2 (1-t)^2 \\
  B_{3,4}(t) &amp;= 4 t^3 (1-t)   \\
  B_{4,4}(t) &amp;=   t^4         \\
\end{aligned}\]
\[\begin{aligned}
  B_{0,4}'(t) &amp;= -4     (1-t)^3        \\
  B_{1,4}'(t) &amp;=  4     (1-t)^2 (1-4t) \\
  B_{2,4}'(t) &amp;=  6 t   (1-t)   (2-4t) \\
  B_{3,4}'(t) &amp;=  4 t^2         (3-4t) \\
  B_{4,4}'(t) &amp;=  4 t^3                \\
\end{aligned}\]
</p>

<h2>5次 (Quintic) B&eacute;zier</h2>

<p>
\[\begin{aligned}
  B_{0,5}(t) &amp;=        (1-t)^5 \\
  B_{1,5}(t) &amp;=  5 t   (1-t)^4 \\
  B_{2,5}(t) &amp;= 10 t^2 (1-t)^3 \\
  B_{3,5}(t) &amp;= 10 t^3 (1-t)^2 \\
  B_{4,5}(t) &amp;=  5 t^4 (1-t)   \\
  B_{5,5}(t) &amp;=    t^5         \\
\end{aligned}\]
\[\begin{aligned}
  B_{0,5}'(t) &amp;= -5     (1-t)^4        \\
  B_{1,5}'(t) &amp;=  5     (1-t)^3 (1-5t) \\
  B_{2,5}'(t) &amp;= 10 t   (1-t)^2 (2-5t) \\
  B_{3,5}'(t) &amp;= 10 t^2 (1-t)   (3-5t) \\
  B_{4,5}'(t) &amp;=  5 t^3         (4-5t) \\
  B_{5,5}'(t) &amp;=  5 t^4                \\
\end{aligned}\]
</p>

</div>
<script>
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
  renderMathInElement(document.body);
});
</script>
</body>
</html>
